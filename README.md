# Docker_ELK
Docker &amp; ELK Stack &amp; Docker Compose &amp; Kubernetis

## HyperVisior 란
- 하이퍼 바이저는 호스트 컴퓨터 1대에서 다수의 운영체제를 동시에 실행할 수 있도록 해주는 가상 플랫폼 기술을 말하며 가상 머신 모니터(Virtual machine monitor)라고도 불림. 
- 여러 개의 OS가 단일 하드웨어 호스트를 공유 할 수 있도록 하는 프로그램이며 각 OS는 호스트의 프로세서, 메모리 및 기타 자원들을 모두 스스로 나타냄.
- 대표적인 시스템으로 Vmware, VirtualBox등이 있음.

![hypervisior](img/hypervisior.png)

## 가상화 시스템 변천사
![virtual_system](img/virtual_system.png)


## Docker 란
- 도커는 ‘컨테이너 기반의 오픈소스 가상화 플랫폼’
- 컨테이너란 : 애플리케이션과 애플리케이션을 구동화는 환경을 격리한 공간

## 컨테이너 시스템 장점
- 기민한 애플리케이션 생성과 배포: VM 이미지를 사용하는 것에 비해 컨테이너 이미지 생성이 보다 쉽고 효율적임.
- 지속적인 개발, 통합 및 배포: 안정적이고 주기적으로 컨테이너 이미지를 빌드해서 배포할 수 있고 (이미지의 불변성 덕에) 빠르고 쉽게 롤백할 수 있다.
- 개발과 운영의 관심사 분리: 배포 시점이 아닌 빌드/릴리스 시점에 애플리케이션 컨테이너 이미지를 만들기 때문에, 애플리케이션이 인프라스트럭처에서 디커플(분리)된다.
- 가시성은 OS 수준의 정보와 메트릭에 머무르지 않고, 애플리케이션의 헬스와 그 밖의 시그널을 볼 수 있다.
- 개발, 테스팅 및 운영 환경에 걸친 일관성: 랩탑에서도 클라우드에서와 동일하게 구동된다.
- 클라우드 및 OS 배포판 간 이식성: Ubuntu, RHEL, CoreOS, on-prem, Google Kubernetes Engine 및 다른 어디에서든 구동된다.
- 애플리케이션 중심 관리: 가상 하드웨어의 OS에서 애플리케이션을 구동하는 수준에서 OS의 논리적인 자원을 사용하여 애플리케이션을 구동하는 수준으로 추상화 수준이 높아진다.
- 느슨하게 커플되고, 분산되고, 유연하며, 자유로운 마이크로서비스: 애플리케이션은 단일 목적의 머신에서 모놀리식 스택으로 구동되지 않고 보다 작고 독립적인 단위로 쪼개져서 동적으로 배포되고 관리될 수 있다.
- 자원 격리: 애플리케이션 성능을 예측할 수 있다.
- 자원 사용량: 고효율 고집적.




## 컨테이너 오케스트레이션 (orchestration) 
- 여러 컨테이너의 배포 프로세스를 최적화 (컨테이너와 호스트의 수가 증가함에 따라 가치도 높아짐)
- 컨테이너를 자동 배포 및 복제 / 컨테이너 장애 복구 / 그룹에 대한 로드 밸런싱 / 클러스터 외부에 서비스 노출 / 컨테이너 확장 및 축소 / 컨테이너 서비스간의 인터페이스를 통한 연결 및 네트워크 포트 노출 제어
- 컴퓨터 시스템과 애플리케이션, 서비스의 자동화된 설정, 관리 조정을 의미
- 오케스트레이션은 IT팀이 복잡한 테스크와 워크플로우를 보다 쉽게 관리할 수 있도록 도움.

## 오케스트레이션 종류
### (1) Kubernetes
![kubernetes](img/kubernetes.png)
  - 쿠버네티스는 컨테이너를 쉽고빠르게 배포/확장하고 관리를 자동화해주는 오픈소스플랫폼
  - 구글에 의해 설계되고 리눅스 재단에 의해 관리됨 기능이 풍부하여 널리 사용되는 오케스트레이션 프레임워크 (100% go언어로 작성)
  - 목적 : 여러 클러스터의 호스트 간에 어플리케이션 컨테이너의 배치, 스케일링, 운영을 자동화하기 위한 플랫폼 제공
  - 베어 메탈, VM환경, 퍼블릿 클라우드 등의 다양한 환경에서 작동하도록 설계됨
  - 컨테이너의 롤링 업그레이드 지원
  - 클라우드 네이티브 애플리케이션 대부분이 쿠버네티스와 찰떡궁합
  

### (2) Docker Swarm

![docker_swarm](img/docker_swarm.png)

  - 여러 개의 Docker 호스트를 함께 클러스터링하여 단일 가상 Docker 호스트 생성
  - 호스트 OS에 Agent만 설치하면 간단하게 작동하고 설정이 쉬움
  - Docker 명령어와 Compose를 그대로 사용 가능
  
### (3) Apache Mesos 
![apache_mesos](img/apache_mesos.png)
- 수만 대의 물리적 시스템으로 확장 할 수 있도록 설계됨
- Hadoop, MPI, Hypertable, Spark와 같은 응용 프로그램을 동적 클러스터 환경에서 리소스 공유와 분리를 통해 자원 최적화 가능
- Docker 컨테이너를 적극 지원

### (4) Amazone ECS
![amazone_ecs](img/amazone_ecs.png)

- Amazon Elastic Container Service(ECS)는 클라우드 서비스로 제공되며 오케스트레이션 시스템 구축을 위한 특별한 준비 없이 사용 가능
- Docker 컨테이너 지원하나 도커의 모든 기능을 사용하기에는 약간 제약이 있고, 세세한 컨트롤이 어렵다. 
- 2015년 릴리즈 이후 서비스 스케일링, 태스크 기반 IAM 지원, 애플리케이션 로드밸런서 지원, 서비스 디스커버리, AWS배치릴리즈, 파게이트(Fargate)지원 등 활용성은 상당히 높은 편
- Amazon ECS를 사용하면 자체 컨테이너 오케스트레이션 소프트웨어를 설치하고 운영할 필요가 없으며, 가상 머신의 클러스터를 관리 및 확장하거나 해당 가상 머신에서 컨테이너를 예약하지 않아도 됩니다.

### (5) tip
- 위 오케스트레이션 도구는 설정방법과 동작방식이 상당히 다름.
- Docker Swam은 Docker 호스트 클러스터를 조정하기 가장 쉬운 방법을 제공하고 있고
- Kubernetes는 컨테이너 서비스 배포 및 관리에 많은 이점을 가지고 있음
- Apache Mesos는 대규모 클러스터링을 지원하고 특히 Hadoop, Kafka 및 Spark와 같은 다른 서비스와 함께 응용 프로그램을 배치해야 하는 환경에 특히 적합함
- Amazon ECS는 클라우드 서비스로 제공되며 오케스트레이션 시스템 구축을 위한 특별한 준비 없이 사용가능

## ELK 란
- ElasticSearch : ElaticSearch 는 Lucene 기반으로 개발한 분산 검색엔진으로, LogStash 를 통해 수신된 데이터를 저장소에 저장하는 역할을 담당

- LogStash : 수집할 로그를 선정해서,  지정된 대상 서버(Elasticsearch)에 인덱싱해서 전송하는 역할을 담당하는 소프트웨어 (다양한 플러그인 제공을 여러 유형의 로그 수집 및 인덱싱이 가능함)

- Kibana : 사용자에게 무언가를 보여주기 위한 목적, <b>Visualization</b> 을 담당하는 HTML + Javascript 엔진이라고 보면 됨

